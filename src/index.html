<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tartamada¬© Mail</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Notification Container -->
    <div id="notificationContainer" class="notification-container"></div>

    <!-- Auth Page -->
    <div id="authPage" class="auth-page">
        <div class="auth-card">
            <div class="logo-container">
                <div class="logo">
                    <svg viewBox="0 0 24 24"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="m2 7 10 7 10-7"/></svg>
                </div>
                <h1>Tartamada¬© Mail</h1>
                <p class="subtitle">Messagerie professionnelle avec fonctionnalit√©s Premium</p>
            </div>

            <!-- Login Form -->
            <div id="loginForm">
                <div class="form-group">
                    <label>Adresse email</label>
                    <input type="text" id="loginEmail" placeholder="utilisateur@tartamada.com">
                </div>
                <div class="form-group">
                    <label>Mot de passe</label>
                    <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <button class="btn btn-primary" onclick="handleLogin()">Se connecter</button>
                <button class="btn btn-secondary" onclick="showSignup()">Cr√©er un compte</button>
            </div>

            <!-- Signup Form -->
            <div id="signupForm" class="hidden">
                <div class="form-group">
                    <label>Nom d'utilisateur</label>
                    <input type="text" id="signupUsername" placeholder="votre-nom">
                    <p class="hint">Votre adresse sera: <span id="emailPreview">@tartamada.com</span></p>
                </div>
                <div class="form-group">
                    <label>Mot de passe</label>
                    <input type="password" id="signupPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <div class="form-group">
                    <label>Confirmer le mot de passe</label>
                    <input type="password" id="signupConfirm" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <button class="btn btn-primary" onclick="handleSignup()">Cr√©er mon compte</button>
                <button class="btn btn-secondary" onclick="showLogin()">D√©j√† un compte ? Se connecter</button>
            </div>
        </div>
    </div>

    <!-- Admin Page -->
    <div id="adminPage" class="hidden">
        <nav class="navbar">
            <div class="navbar-content">
                <div class="navbar-left">
                    <div class="navbar-logo">
                        <svg viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                    </div>
                    <div>
                        <div style="font-size: 20px; font-weight: 700;">Panneau Administrateur</div>
                        <div style="font-size: 13px; opacity: 0.9;" id="adminName">Admin</div>
                    </div>
                </div>
                <div class="navbar-right">
                    <button class="theme-toggle" onclick="toggleTheme()">
                        <svg id="themeIcon" viewBox="0 0 24 24"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
                    </button>
                    <button class="nav-btn" onclick="showInbox()">
                        <svg viewBox="0 0 24 24"><polyline points="22 12 16 12 14 15 10 15 8 12 2 12"/><path d="M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"/></svg>
                        Ma bo√Æte mail
                    </button>
                    <button class="nav-btn" onclick="handleLogout()">
                        <svg viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
                        D√©connexion
                    </button>
                </div>
            </div>
        </nav>

        <div class="container">
            <div class="stats-grid">
                <div class="stat-card blue">
                    <div class="stat-icon">
                        <svg viewBox="0 0 24 24"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                    </div>
                    <div class="stat-label">Utilisateurs totaux</div>
                    <div class="stat-value" id="totalUsers">0</div>
                </div>
                <div class="stat-card green">
                    <div class="stat-icon">
                        <svg viewBox="0 0 24 24"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2z"/></svg>
                    </div>
                    <div class="stat-label">Comptes Premium</div>
                    <div class="stat-value" id="premiumUsers">0</div>
                </div>
                <div class="stat-card purple">
                    <div class="stat-icon">
                        <svg viewBox="0 0 24 24"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
                    </div>
                    <div class="stat-label">Messages envoy√©s</div>
                    <div class="stat-value" id="totalEmails">0</div>
                </div>
            </div>

            <div class="main-content">
                <div style="padding: 40px;">
                    <h2 style="display: flex; align-items: center; gap: 12px; margin-bottom: 30px; font-size: 24px;">
                        <svg viewBox="0 0 24 24"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                        Gestion des utilisateurs
                    </h2>
                    <div id="userList">Chargement...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Inbox Page -->
    <div id="inboxPage" class="hidden">
        <nav class="navbar">
            <div class="navbar-content">
                <div class="navbar-left">
                    <div class="navbar-logo">
                        <svg viewBox="0 0 24 24"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="m2 7 10 7 10-7"/></svg>
                    </div>
                    <div>
                        <div style="font-size: 20px; font-weight: 700;">Tartamada¬© Mail</div>
                        <div style="font-size: 13px; opacity: 0.9;" id="userEmail"></div>
                    </div>
                </div>
                <div class="navbar-right">
                    <button class="theme-toggle" onclick="toggleTheme()">
                        <svg id="themeIcon2" viewBox="0 0 24 24"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
                    </button>
                    <div class="user-profile-nav" onclick="showProfileSettings()">
                        <div class="user-avatar-nav" id="navAvatar"></div>
                        <span id="navUsername"></span>
                    </div>
                    <button class="nav-btn" id="adminBtn" onclick="showAdmin()" style="display: none;">
                        <svg viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                        Admin
                    </button>
                    <button class="nav-btn" onclick="handleLogout()">
                        <svg viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
                        D√©connexion
                    </button>
                </div>
            </div>
        </nav>

        <div class="container">
            <!-- Premium Banner for free users -->
            <div id="premiumBanner" class="premium-banner" style="display: none;">
                <div class="premium-banner-content">
                    <div class="premium-banner-icon">üëë</div>
                    <div class="premium-banner-text">
                        <h4>Passez √† Premium et d√©bloquez toutes les fonctionnalit√©s !</h4>
                        <p>Th√®mes personnalis√©s, signatures, statistiques, envoi illimit√© et bien plus...</p>
                    </div>
                </div>
                <button class="premium-banner-btn" onclick="showProfileSettings()">
                    D√©couvrir Premium - 4,99‚Ç¨/mois
                </button>
                <button class="premium-banner-close" onclick="closePremiumBanner()">
                    <svg viewBox="0 0 24 24" style="width: 16px; height: 16px;"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                </button>
            </div>
            
            <div class="inbox-layout">
                <div class="sidebar">
                    <div class="sidebar-section">
                        <div class="sidebar-title">Dossiers</div>
                        <div class="sidebar-item active" onclick="filterEmails('inbox')">
                            <svg viewBox="0 0 24 24"><polyline points="22 12 16 12 14 15 10 15 8 12 2 12"/><path d="M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"/></svg>
                            <span>R√©ception</span>
                            <span class="sidebar-badge" id="inboxBadge">0</span>
                        </div>
                        <div class="sidebar-item" onclick="filterEmails('unread')">
                            <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
                            <span>Non lus</span>
                            <span class="sidebar-badge" id="unreadBadge">0</span>
                        </div>
                        <div class="sidebar-item" onclick="filterEmails('starred')">
                            <svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
                            <span>Favoris</span>
                        </div>
                        <div class="sidebar-item" onclick="filterEmails('sent')">
                            <svg viewBox="0 0 24 24"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
                            <span>Envoy√©s</span>
                        </div>
                        <div class="sidebar-item" onclick="filterEmails('drafts')">
                            <svg viewBox="0 0 24 24"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                            <span>Brouillons</span>
                        </div>
                        <div class="sidebar-item" onclick="filterEmails('trash')">
                            <svg viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
                            <span>Corbeille</span>
                        </div>
                    </div>
                    <div class="sidebar-section">
                        <div class="sidebar-title">Actions</div>
                        <div class="sidebar-item" onclick="showCompose()">
                            <svg viewBox="0 0 24 24"><path d="M12 5v14"/><path d="M5 12h14"/></svg>
                            <span>Nouveau message</span>
                        </div>
                    </div>
                    <div class="sidebar-section" id="premiumSection" style="display: none;">
                        <div class="sidebar-title">Premium üëë</div>
                        <div style="background: linear-gradient(135deg, #fff9e6 0%, #ffecb3 100%); padding: 12px; border-radius: 10px; font-size: 12px;">
                            <div style="font-weight: 700; margin-bottom: 8px; display: flex; align-items: center; gap: 6px;">
                                Statistiques
                            </div>
                            <div style="color: #666; margin-bottom: 4px;">
                                üìä <span id="sentToday">0</span> envoy√©s aujourd'hui
                            </div>
                            <div style="color: #666; margin-bottom: 4px;">
                                ‚≠ê <span id="starredCount">0</span> favoris
                            </div>
                            <div style="color: #666; margin-bottom: 8px;">
                                üíæ <span id="draftsCount">0</span> brouillons
                            </div>
                            <button onclick="toggleAutoReply()" style="width: 100%; padding: 8px; background: white; border: 1px solid var(--premium); border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600; color: #666; margin-bottom: 6px;">
                                ${currentUser?.autoReply?.enabled ? 'üîï R√©p. Auto: ON' : 'üìß Activer R√©p. Auto'}
                            </button>
                            <button onclick="exportEmails()" style="width: 100%; padding: 8px; background: white; border: 1px solid var(--premium); border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600; color: #666;">
                                üì• Exporter emails
                            </button>
                        </div>
                    </div>
                    <div class="sidebar-section" id="freeUserInfo" style="display: none;">
                        <div style="background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%); padding: 12px; border-radius: 10px; font-size: 12px;">
                            <div style="font-weight: 700; margin-bottom: 8px; color: #666;">
                                üÜì Compte Gratuit
                            </div>
                            <div style="color: #666; margin-bottom: 8px; font-size: 11px;">
                                <strong id="dailyLimit">0/50</strong> emails envoy√©s aujourd'hui
                            </div>
                            <button onclick="showProfileSettings()" style="width: 100%; padding: 8px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 700; color: white;">
                                ‚≠ê Passer √† Premium
                            </button>
                        </div>
                    </div>
                </div>

                <div class="main-content">
                    <div class="content-header">
                        <h2>
                            <svg viewBox="0 0 24 24"><polyline points="22 12 16 12 14 15 10 15 8 12 2 12"/><path d="M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"/></svg>
                            <span id="viewTitle">Bo√Æte de r√©ception</span>
                        </h2>
                        <div style="display: flex; gap: 12px; align-items: center;">
                            <div class="search-box">
                                <input type="text" id="searchInput" placeholder="Rechercher..." onkeyup="searchEmails()">
                                <div class="search-icon">
                                    <svg viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
                                </div>
                            </div>
                            <button class="nav-btn" onclick="showCompose()">
                                <svg viewBox="0 0 24 24"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
                                Nouveau
                            </button>
                        </div>
                    </div>

                    <!-- Toolbar -->
                    <div class="email-toolbar" id="emailToolbar" style="display: none;">
                        <div class="email-checkbox" onclick="toggleSelectAll()"></div>
                        <span id="selectedCount" style="font-size: 13px; color: var(--text-secondary);">0 s√©lectionn√©(s)</span>
                        <div class="toolbar-separator"></div>
                        <button class="toolbar-btn" onclick="markAsRead()">
                            <svg viewBox="0 0 24 24"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
                            Marquer comme lu
                        </button>
                        <button class="toolbar-btn" onclick="starSelected()">
                            <svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
                            Favoris
                        </button>
                        <button class="toolbar-btn" onclick="moveToTrash()">
                            <svg viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
                            Supprimer
                        </button>
                    </div>

                    <!-- Email List -->
                    <div id="emailListView">
                        <div id="emailList"></div>
                    </div>

                    <!-- Email View -->
                    <div id="emailView" class="email-view hidden"></div>

                    <!-- Compose -->
                    <div id="composeView" class="compose-form hidden">
                        <h3>‚úâÔ∏è Nouveau message</h3>
                        <div class="form-group">
                            <label>Destinataire</label>
                            <input type="email" id="composeTo" placeholder="utilisateur@tartamada.com">
                        </div>
                        <div class="form-group">
                            <label>Objet</label>
                            <input type="text" id="composeSubject" placeholder="Objet du message">
                        </div>
                        <div class="form-group">
                            <label>Message</label>
                            <textarea id="composeBody" placeholder="Votre message..."></textarea>
                        </div>
                        
                        <!-- Attachments Section -->
                        <div id="composeAttachmentsSection" class="compose-attachments hidden">
                            <div class="compose-attachments-title">
                                <svg viewBox="0 0 24 24" style="width: 16px; height: 16px;"><path d="m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"/></svg>
                                Pi√®ces jointes (<span id="attachmentCount">0</span>)
                            </div>
                            <div class="compose-attachment-list" id="composeAttachmentList"></div>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-primary" onclick="handleSendEmail()">
                                <svg viewBox="0 0 24 24" style="width: 18px; height: 18px;"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
                                Envoyer
                            </button>
                            <div class="file-input-wrapper">
                                <input type="file" id="fileInput" multiple onchange="handleFileSelect(event)">
                                <label for="fileInput" class="file-input-label">
                                    <svg viewBox="0 0 24 24" style="width: 18px; height: 18px;"><path d="m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"/></svg>
                                    Joindre fichier
                                </label>
                            </div>
                            <button class="btn btn-cancel" onclick="saveDraft()">üíæ Brouillon</button>
                            <button class="btn btn-cancel" onclick="cancelCompose()">Annuler</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
